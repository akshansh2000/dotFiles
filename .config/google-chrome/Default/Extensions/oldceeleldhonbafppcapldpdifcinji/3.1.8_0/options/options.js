/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
{const e=document.getElementById("banner"),t=document.getElementById("login"),n=document.getElementById("login-options"),o=document.getElementById("logout-button"),i=document.getElementById("managed-login"),a=document.getElementById("managed-login-options"),s=document.getElementById("managed-login-button"),l=document.getElementById("managed-logout-button"),d=document.getElementById("lt-options-discount"),r=document.getElementById("personalDictionary"),c=document.getElementById("personalDictionary-options"),u=document.getElementById("personalDictionaryList"),g=document.getElementById("personalDictionaryInput"),m=document.getElementById("addToPersonalDictionary"),p=document.getElementById("personalDictionary-options__clearAll"),y=document.getElementById("personalDictionary-options__copy"),D=document.getElementById("ignoredRules"),h=document.getElementById("ignoredRules-options"),E=document.getElementById("ignoredRulesList"),v=document.getElementById("ignoredRules-options__clearAll"),k=document.getElementById("disabledDomains"),b=document.getElementById("disabledDomains-options"),S=document.getElementById("disabledDomainsList"),f=document.getElementById("disabledDomainsInput"),I=document.getElementById("addToDisabledDomains"),L=document.getElementById("disabledDomains-options__clearAll"),C=document.getElementById("experimental"),_=document.getElementById("experimental-options"),B=document.getElementById("serverUrl"),A=document.getElementById("serverType-cloud"),R=document.getElementById("serverType-local"),T=document.getElementById("serverType-custom"),M=document.getElementById("localServerAvailabilityWarning"),P=document.getElementById("retryLocalServer"),w=document.getElementById("customServerUrl"),U=document.getElementById("motherTongue"),V=document.getElementById("variant-en"),x=document.getElementById("variant-de"),O=document.getElementById("variant-pt"),N=document.getElementById("variant-ca"),H=document.getElementById("autoCheckAllDomains"),$=document.getElementById("autoCheckDomains-options"),z=document.getElementById("autoCheckDomains"),Y=document.getElementById("autoCheckDomainInput"),q=document.getElementById("addToAutoCheckDomains"),F=document.getElementById("autoCheckDomains-options__clearAll"),W=document.getElementById("ignoredDomains-options"),j=document.getElementById("ignoredDomains"),G=document.getElementById("ignoredDomainInput"),J=document.getElementById("addToIgnoredDomains"),K=document.getElementById("ignoredDomains-options__clearAll"),Q=/^(https?:\/\/)?[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,15}(:[0-9]{1,5})?(\/.*)?$/i,X=/^(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}$/;function isValidURL(e){return"localhost"===e||Q.test(e)||X.test(e)}function localize(){translateSection(document.documentElement),translateElement("#havePremiumAccountDesc",{key:"havePremiumAccountDesc",isHTML:!0,interpolations:["https://languagetoolplus.com/webextension/upgrade?pk_campaign=addon2-options"]}),document.getElementById("privacyPolicy").innerHTML="<a target='_blank' href='https://languagetool.org/privacy/'>"+i18nManager.getMessage("privacyPolicy")+"</a>"}function loadSettings(){renderPremiumState(),renderPersonalDictionary(),renderIgnoredRules(),renderDisabledDomains(),renderManagedSettingsState();const e=te.getSettings();e.apiServerUrl===config.MAIN_SERVER_URL?A.checked=!0:e.apiServerUrl===config.LOCAL_SERVER_URL?R.checked=!0:(T.checked=!0,w.value=e.apiServerUrl,renderOtherServerSetting(!0)),U.value=e.motherTongue,V.value=e.enVariant,x.value=e.deVariant,O.value=e.ptVariant,N.value=e.caVariant,H.checked=e.autoCheck,toggleAutoCheck(e.autoCheck),renderAutoCheckDomains(),renderIgnoredDomains()}function renderPremiumState(){const{hasPaidSubscription:e}=te.getUIState();document.body.classList.toggle("lt-options--plus",e),toggleAccountSection(),renderManagedSettingsState()}function renderManagedSettingsState(){const{apiServerUrl:o,disablePersonalDictionary:s,disableIgnoredRules:l,loginUrl:d}=te.getManagedSettings(),{havePremiumAccount:u,username:g}=te.getSettings();s&&(r.style.display="none",c.style.display="none"),l&&(D.style.display="none",h.style.display="none"),o&&(B.style.display="none",e.style.display="none"),d&&(e.style.display="none",t.style.display="none",n.style.display="none",i.style.display="",a.style.display="");const m=document.getElementById("managed-login-box"),p=document.getElementById("managed-logout-box");u?(m.style.display="none",p.style.display="block",translateElement("#managed-account-text",{key:"settingsLoggedInAs",isHTML:!0,interpolations:[`<strong>${g}</strong>`]})):(m.style.display="block",p.style.display="none")}function toggleAccountSection(){const{havePremiumAccount:e,username:t}=te.getSettings(),n=document.getElementById("lt-login"),o=document.getElementById("lt-account");e?(n.style.display="none",o.style.display="block",B.style.display="none",translateElement("#account-text",{key:"settingsLoggedInAs",isHTML:!0,interpolations:[`<strong>${t}</strong>`]})):(n.style.display="block",o.style.display="none",B.style.display="block")}function login(){const e=document.getElementById("login-success"),t=document.getElementById("login-error"),n=document.getElementById("username"),o=document.getElementById("password"),i=n.value,a=o.value;e.style.display="none",t.style.display="none",n.disabled=!0,o.disabled=!0,fetch(`${config.PREMIUM_SERVER_URL}/users/me`,{method:"get",mode:"cors",headers:{Authorization:`Basic ${btoa(i+":"+a)}`}}).then(e=>{if(!e.ok)throw"invalid login";return e.json()}).then(e=>te.updateSettings({username:i,password:"",token:e.addon_token,knownEmail:i,havePremiumAccount:!0,apiServerUrl:config.MAIN_SERVER_URL})).then(()=>(Tracker.trackEvent("Action","login",i),e.style.display="block",translateElement(e,"settingsLoginSuccess"),te.checkForPaidSubscription())).then(()=>{renderPremiumState(),EnvironmentAdapter.startDictionarySync()}).catch(()=>{Tracker.trackEvent("Action","login_error",i),t.style.display="block",translateElement(t,"settingsLoginError")}).then(()=>{n.disabled=!1,o.disabled=!1})}function managedLogin(){const{loginUrl:e}=te.getManagedSettings();goToManagedLogin(e,(e,t)=>(te.updatePrivacySettings({allowRemoteCheck:!0}),te.updateSettings({username:e,password:"",token:t,knownEmail:e,havePremiumAccount:!0}).then(()=>(renderManagedSettingsState(),te.checkForPaidSubscription())).then(()=>{renderPremiumState(),browser.runtime.sendMessage({command:"START_DICTIONARY_SYNC"})})))}function logout(){const e=document.getElementById("login-success"),t=document.getElementById("login-error"),n=document.getElementById("username"),o=document.getElementById("password");te.updateSettings({username:"",password:"",token:"",isDictionarySynced:!1,havePremiumAccount:!1}).then(()=>{Tracker.trackEvent("Action","logout"),e.style.display="block",translateElement(e,"settingsLogoutSuccess")}).catch(()=>{t.style.display="block",translateElement(t,"settingsUnknownError")}).then(()=>{n.disabled=!1,o.disabled=!1,te.checkForPaidSubscription().then(renderPremiumState)})}function managedLogout(){te.updateSettings({username:"",password:"",token:"",isDictionarySynced:!1,havePremiumAccount:!1}).then(()=>{renderManagedSettingsState(),te.checkForPaidSubscription().then(renderPremiumState)})}function renderPersonalDictionary(e=Dictionary.getSorted(),t=0===Dictionary.get().length){u.innerHTML="";for(const t of e){const e=document.createElement("li");e.className="lt-options__personalDictionary__item";const n=document.createElement("span");n.className="lt-options__personalDictionary__title",n.textContent=t,e.appendChild(n);const o=document.createElement("span");o.className="lt-options__personalDictionary__delete-button",o.dataset.word=t,o.addEventListener("click",deletePersonalDictionaryButtonClick),e.appendChild(o),u.appendChild(e)}const n=document.getElementById("personalDictionary-optionsInside"),o=document.getElementById("personalDictionary-options__emptyState"),i=document.getElementById("personalDictionary-options__emptySearch");e.length>0?(n.style.display="block",o.style.display="none",i.style.display="none"):t?(n.style.display="none",o.style.display="block",i.style.display="none"):(n.style.display="none",o.style.display="none",i.style.display="block")}function filterPersonalDictionary(){const e=g.value;m.disabled=""===e.trim();const t=Dictionary.getSorted(),n=[];for(const o of t)o.includes(e)&&n.push(o);renderPersonalDictionary(n,0===t.length)}function pastePersonalDictionary(e){if(g.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);n.length<=1||(e.preventDefault(),Dictionary.addBatch(n).then(()=>renderPersonalDictionary()))}function addToPersonalDictionary(){const e=g.value.trim();e&&(Dictionary.add(e).then(()=>renderPersonalDictionary()),g.value="",m.disabled=!0)}function deletePersonalDictionaryButtonClick(e){const t=e.currentTarget.dataset.word;t&&Dictionary.remove(t).then(filterPersonalDictionary)}function clearPersonalDictionary(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&Dictionary.clear().then(()=>renderPersonalDictionary([],!0))}function copyPersonalDictionary(){const e=Dictionary.getSorted(),t=document.createElement("textarea");t.value=e.join("\n"),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t);const n=document.getElementById("personalDictionary-options__copyMessage");n.style.display="block",wait(3e3).then(()=>fadeOut(n,()=>{n.style.display="none",n.style.opacity="1"}))}function renderIgnoredRules(){E.innerHTML="";const e=te.getSettings().ignoredRules,t=i18nManager.getMessage("enableRuleTooltip");for(const n of e){if(n.language){const e=LanguageManager.getUserLanguageCodes().some(e=>n.language.toLowerCase().startsWith(e)||"*"===n.language);if(StorageControllerClass.getDefaultSettings().ignoredRules.some(e=>e.id===n.id)&&!e)continue}const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="- "+(n.description||n.id),e.appendChild(o);const i=document.createElement("span");i.className="lt-options__rules__enable-button",i.setAttribute("title",t),i.dataset.ruleId=n.id,i.textContent=t,i.addEventListener("click",onEnableRuleButtonClick),e.appendChild(i),E.appendChild(e)}const n=document.getElementById("ignoredRules-optionsInside"),o=document.getElementById("ignoredRules-options__emptyState");e.length>0?(n.style.display="block",o.style.display="none"):(n.style.display="none",o.style.display="block")}function onEnableRuleButtonClick(e){const t=e.currentTarget.dataset.ruleId;if(t){const e=te.getSettings().ignoredRules.filter(e=>e.id!==t);te.updateSettings({ignoredRules:e}).then(renderIgnoredRules)}}function enableAllIgnoredRules(){te.updateSettings({ignoredRules:[]}).then(renderIgnoredRules)}function renderDisabledDomains(e=te.getSettings().disabledDomains,t=te.getSettings().disabledDomains.length>0){S.innerHTML="";const n=i18nManager.getMessage("settingsEnableDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="● "+t,e.appendChild(o);const i=document.createElement("span");i.className="lt-options__rules__enable-button",i.setAttribute("title",n),i.dataset.domain=t,i.textContent=n,i.addEventListener("click",onEnableDomainButtonClick),e.appendChild(i),S.appendChild(e)}const o=document.getElementById("disabledDomains-optionsInside"),i=document.getElementById("disabledDomains-options__emptyState"),a=document.getElementById("disabledDomains-options__emptySearch");e.length>0?(o.style.display="block",i.style.display="none",a.style.display="none"):t?(o.style.display="none",i.style.display="block",a.style.display="none"):(o.style.display="none",i.style.display="none",a.style.display="block")}function filterDisabledDomains(){const e=f.value;I.disabled=""===e.trim();const t=te.getSettings().disabledDomains.sort((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())),n=[];for(const o of t)o.includes(e)&&n.push(o);renderDisabledDomains(n,0===t.length)}function pasteDisabledDomains(e){if(f.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const o=te.getSettings().disabledDomains;n.forEach(e=>{const t=getDomain(e,"");t.trim()&&isValidURL(e)&&!o.includes(t)&&o.push(t)}),te.updateSettings({disabledDomains:o}).then(filterDisabledDomains)}function addToDisabledDomains(){const e=f.value.trim(),t=getDomain(e,"");if(""===t.trim()||!isValidURL(e))return void alert(i18nManager.getMessage("settingsDomainInvalid"));f.value="",I.disabled=!0;const n=te.getSettings().disabledDomains;n.includes(t)||(n.push(t),te.updateSettings({disabledDomains:n}).then(()=>renderDisabledDomains(n,!1)))}function onEnableDomainButtonClick(e){const t=e.currentTarget.dataset.domain;if(t){const e=te.getSettings().disabledDomains.filter(e=>e!==t);te.updateSettings({disabledDomains:e}).then(filterDisabledDomains)}}function enableAllDisabledDomains(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&te.updateSettings({disabledDomains:[]}).then(()=>renderDisabledDomains([],!0))}function toggleServerType(){renderOtherServerSetting(T.checked),R.checked?checkLocalServerAvailability():M.style.display="none"}function renderOtherServerSetting(e=!1){w.style.display=e?"block":"none",w.required=e,e?w.value=w.dataset.prevValue||"":(w.dataset.prevValue=w.value,w.value="")}function checkLocalServerAvailability(){fetch(config.LOCAL_SERVER_URL+"/languages",{method:"GET",mode:"cors"}).then(()=>{M.style.display="none"}).catch(()=>{M.style.display="block"})}function saveServerUrl(){let e="";e=A.checked?config.MAIN_SERVER_URL:R.checked?config.LOCAL_SERVER_URL:w.value.trim();const t=document.getElementById("serverUrl-success"),n=document.getElementById("serverUrl-error");te.updateSettings({apiServerUrl:e}).then(()=>{te.checkForPaidSubscription().then(()=>{renderPremiumState()}),t.style.display="block",wait(3e3).then(()=>fadeOut(t,()=>{t.style.display="none",t.style.opacity="1"}))}).catch(()=>{n.style.display="block",wait(3e3).then(()=>fadeOut(n,()=>{n.style.display="none",n.style.opacity="1"}))})}function saveMotherTongue(){te.updateSettings({motherTongue:U.value})}function saveVariantEn(){te.updateSettings({enVariant:V.value})}function saveVariantDe(){te.updateSettings({deVariant:x.value})}function saveVariantPt(){te.updateSettings({ptVariant:O.value})}function saveVariantCa(){te.updateSettings({caVariant:N.value})}function toggleAutoCheck(e=!1){$.style.display=e?"none":"",W.style.display=e?"":"none"}function renderAutoCheckDomains(e=te.getSettings().autoCheckOnDomains,t=0===te.getSettings().autoCheckOnDomains.length){z.innerHTML="";const n=i18nManager.getMessage("settingsDeleteAutoCheckDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="● "+t,e.appendChild(o);const i=document.createElement("span");i.className="lt-options__rules__enable-button",i.setAttribute("title",n),i.dataset.domain=t,i.textContent=n,i.addEventListener("click",onDeleteAutoCheckDomainButtonClick),e.appendChild(i),z.appendChild(e)}const o=document.getElementById("autoCheckDomains-optionsInside"),i=document.getElementById("autoCheckDomains-options__emptyState"),a=document.getElementById("autoCheckDomains-options__emptySearch");e.length>0?(o.style.display="block",i.style.display="none",a.style.display="none"):t?(o.style.display="none",i.style.display="block",a.style.display="none"):(o.style.display="none",i.style.display="none",a.style.display="block")}function filterAutoCheckDomains(){const e=Y.value;q.disabled=""===e.trim();const t=te.getSettings().autoCheckOnDomains.sort((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())),n=[];for(const o of t)o.includes(e)&&n.push(o);renderAutoCheckDomains(n,0===t.length)}function pasteAutoCheckDomains(e){if(Y.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const o=te.getSettings().autoCheckOnDomains;n.forEach(e=>{const t=getDomain(e,"");t.trim()&&isValidURL(e)&&!o.includes(t)&&o.push(t)}),te.updateSettings({autoCheckOnDomains:o}).then(filterAutoCheckDomains)}function addToAutoCheckDomains(){const e=Y.value.trim(),t=getDomain(e,"");if(""===t.trim()||!isValidURL(e))return void alert(i18nManager.getMessage("settingsDomainInvalid"));Y.value="",q.disabled=!0;const n=te.getSettings().autoCheckOnDomains;n.includes(t)||(n.push(t),te.updateSettings({autoCheckOnDomains:n}).then(()=>renderAutoCheckDomains(n,!1)))}function onDeleteAutoCheckDomainButtonClick(e){const t=e.currentTarget.dataset.domain;if(t){const e=te.getSettings().autoCheckOnDomains.filter(e=>e!==t);te.updateSettings({autoCheckOnDomains:e}).then(()=>renderAutoCheckDomains(e,0===e.length))}}function deleteAllAutoCheckDomains(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&te.updateSettings({autoCheckOnDomains:[]}).then(()=>renderAutoCheckDomains([],!0))}function renderIgnoredDomains(e=te.getSettings().ignoreCheckOnDomains,t=0===te.getSettings().ignoreCheckOnDomains.length){j.innerHTML="";const n=i18nManager.getMessage("settingsDeleteIgnoredDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="● "+t,e.appendChild(o);const i=document.createElement("span");i.className="lt-options__rules__enable-button",i.setAttribute("title",n),i.dataset.domain=t,i.textContent=n,i.addEventListener("click",onDeleteIgnoredDomainButtonClick),e.appendChild(i),j.appendChild(e)}const o=document.getElementById("ignoredDomains-optionsInside"),i=document.getElementById("ignoredDomains-options__emptyState"),a=document.getElementById("ignoredDomains-options__emptySearch");e.length>0?(o.style.display="block",i.style.display="none",a.style.display="none"):t?(o.style.display="none",i.style.display="block",a.style.display="none"):(o.style.display="none",i.style.display="none",a.style.display="block")}function filterIgnoredDomains(){const e=G.value;J.disabled=""===e.trim();const t=te.getSettings().ignoreCheckOnDomains.sort((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase())),n=[];for(const o of t)o.includes(e)&&n.push(o);renderIgnoredDomains(n,0===t.length)}function pasteIgnoredDomains(e){if(G.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const o=te.getSettings().ignoreCheckOnDomains;n.forEach(e=>{const t=getDomain(e);t.trim()&&isValidURL(e)&&!o.includes(t)&&o.push(t)}),te.updateSettings({ignoreCheckOnDomains:o}).then(filterIgnoredDomains)}function addToIgnoredDomains(){const e=G.value.trim(),t=getDomain(e);if(""===t.trim()||!isValidURL(e))return void alert(i18nManager.getMessage("settingsDomainInvalid"));G.value="",J.disabled=!0;const n=te.getSettings().ignoreCheckOnDomains;n.includes(t)||(n.push(t),te.updateSettings({ignoreCheckOnDomains:n}).then(()=>renderIgnoredDomains(n,!1)))}function onDeleteIgnoredDomainButtonClick(e){const t=e.currentTarget.dataset.domain;if(t){const e=te.getSettings().ignoreCheckOnDomains.filter(e=>e!==t);te.updateSettings({ignoreCheckOnDomains:e}).then(()=>renderIgnoredDomains(e,0===e.length))}}function deleteAllIgnoredDomains(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&te.updateSettings({ignoreCheckOnDomains:[]}).then(()=>renderIgnoredDomains([],!0))}localize();const Z=location.hash.replace(/\?.*$/,""),ee=document.querySelector(Z||"#login");ee&&ee.nextElementSibling&&ee.nextElementSibling.classList.contains("lt-toggle-box")&&(ee.classList.add("lt-options-toggle-visible"),ee.nextElementSibling.classList.add("lt-options-visible"),Z&&document.documentElement.scrollTo(0,ee.offsetTop-75)),LanguageManager.getUserLanguageCodes().some(e=>e.startsWith("de")||e.startsWith("fr")||e.startsWith("nl"))&&(document.getElementById("made-in-potsdam").style.display="inline");const te=StorageController.create();let ne;te.onReady(loadSettings),te.onReady(()=>{te.startChangelogCoupon();const e=te.getActiveCoupon();e&&(window.clearInterval(ne),ne=window.setInterval(()=>{d.querySelector("#lt-options-dicount-percent").textContent=i18nManager.getMessage("upgradeTeaserDiscount",[e.percent]),d.querySelector("#lt-options-discount-expires").textContent=` – ${i18nManager.getMessage("changelogDiscountExpires")} ${getCountdown(e.expires)}`,d.classList.add("lt-options__discount--visible")},1e3))}),Dictionary.init(te),Tracker.trackPageView(),t.addEventListener("click",e=>{t.classList.toggle("lt-options-toggle-visible"),n.classList.toggle("lt-options-visible")}),i.addEventListener("click",e=>{i.classList.toggle("lt-options-toggle-visible"),a.classList.toggle("lt-options-visible")}),o.addEventListener("click",e=>{e.preventDefault(),logout()}),s.addEventListener("click",e=>{e.preventDefault(),managedLogin()}),l.addEventListener("click",e=>{e.preventDefault(),managedLogout()}),n.addEventListener("submit",e=>{e.preventDefault(),login()}),r.addEventListener("click",()=>{c.classList.toggle("lt-options-visible"),r.classList.toggle("lt-options-toggle-visible")&&g.focus()}),g.addEventListener("keydown",e=>{"Enter"===e.key&&addToPersonalDictionary()}),g.addEventListener("input",()=>{setTimeout(filterPersonalDictionary,0)}),g.addEventListener("paste",pastePersonalDictionary),m.addEventListener("click",addToPersonalDictionary),p.addEventListener("click",clearPersonalDictionary),y.addEventListener("click",copyPersonalDictionary),D.addEventListener("click",()=>{D.classList.toggle("lt-options-toggle-visible"),h.classList.toggle("lt-options-visible")}),v.addEventListener("click",enableAllIgnoredRules),k.addEventListener("click",()=>{b.classList.toggle("lt-options-visible"),k.classList.toggle("lt-options-toggle-visible")&&f.focus()}),f.addEventListener("keydown",e=>{"Enter"===e.key&&addToDisabledDomains()}),f.addEventListener("input",()=>{setTimeout(filterDisabledDomains,0)}),f.addEventListener("paste",pasteDisabledDomains),I.addEventListener("click",addToDisabledDomains),L.addEventListener("click",enableAllDisabledDomains),C.addEventListener("click",e=>{C.classList.toggle("lt-options-toggle-visible"),_.classList.toggle("lt-options-visible")}),A.addEventListener("click",toggleServerType),R.addEventListener("click",toggleServerType),T.addEventListener("click",toggleServerType),P.addEventListener("click",e=>{e.preventDefault(),checkLocalServerAvailability()}),B.addEventListener("submit",e=>{e.preventDefault(),saveServerUrl()}),U.addEventListener("change",saveMotherTongue),V.addEventListener("change",saveVariantEn),x.addEventListener("change",saveVariantDe),O.addEventListener("change",saveVariantPt),N.addEventListener("change",saveVariantCa),H.addEventListener("input",()=>{te.updateSettings({autoCheck:H.checked}),toggleAutoCheck(H.checked)}),Y.addEventListener("keydown",e=>{"Enter"===e.key&&addToAutoCheckDomains()}),Y.addEventListener("input",()=>{setTimeout(filterAutoCheckDomains,0)}),Y.addEventListener("paste",pasteAutoCheckDomains),q.addEventListener("click",addToAutoCheckDomains),F.addEventListener("click",deleteAllAutoCheckDomains),G.addEventListener("keydown",e=>{"Enter"===e.key&&addToIgnoredDomains()}),G.addEventListener("input",()=>{setTimeout(filterIgnoredDomains,0)}),G.addEventListener("paste",pasteIgnoredDomains),J.addEventListener("click",addToIgnoredDomains),K.addEventListener("click",deleteAllIgnoredDomains),te.onReady(()=>{const e=document.querySelector("#heart");if(e){const{showRuleId:t}=te.getUIState();let n=0;e.style.cursor="default",e.style.userSelect="none",t&&(e.style.color="blue"),e.addEventListener("click",o=>{4==++n&&(t?(e.style.color="",te.updateUIState({showRuleId:!1})):(e.style.color="blue",te.updateUIState({showRuleId:!0}))),o.preventDefault()})}})}